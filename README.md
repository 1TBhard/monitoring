# Monitoring

## 소개

와탭랩스의 OpenAPI를 이용한 모니터링 페이지입니다.

## 설치 및 실행환경

- 실행환경
  - node: 16 이상
  - yarn: 1.22 이상

- 설치

```cmd
yarn install
```

- 실행

```cmd
yarn start
```

## 과제 요구 사항

- 데이터 요청
  - [ ] Endpoint를 기준으로 10개 이상의 Open API를 사용하여 대시보드를 구성합니다.
  - [x] 실시간 : 5초 주기로 데이터를 갱신합니다.

- 컴포넌트 제작
  - [x] 1개 이상의 인포매틱스 위젯 (지표 이름과 값을 단순 텍스트 형식으로 표시하는 위
젯)
  - [ ] 1개 이상의 막대 차트 위젯
  - [x] 1개 이상의 라인 차트 위젯
  - [ ] 화면 크기에 대한 반응형 레이아웃 스타일을 적용합니다.

## 제약 조건

- [x] 리액트 라이브러리를 사용합니다.
- [x] 타입스크립트를 사용합니다.

## 주요 프레임워크 및 라이브러리

사용한 프레임워크 및 라이브러리 중 중요한 것들은 아래와 같습니다.

- react
  - 재사용성이 극대화 됩니다.
- typescript
  - 정적 타입 검사 등의 많은 이점을 가지고 있어 사용하였습니다.
- axios
  - 비동기 통신 처리를 유연하게 하기 위해 사용하였습니다.
- react-query
  - 캐시 설정 및 hook과 같은 헬퍼 함수를 사용하여 최적화를 하기 위해 사용하였습니다.
- antd
  - 컴포넌트를 빠르게 구축게 구축하고자 사용하였습니다.
- styled-components
  - CSS-in-JS 를 활용하여 스타일 요소도 재사용성을 극대화하고자 사용하였습니다.
- antd-chart
  - 차트 라이브러리로 antd와 궁합이 잘맞아 사용하였습니다.

## 폴더 구조

```txt
src
  ├── api
  ├── component
  ├── const
  ├── hook
  ├── page
  ├── style
  ├── type
  └── util
```

폴더|설명
:--:|:--
api | api 관련 함수들이 있는 폴더
component | - 컴포넌트들이 있는 폴더 <br/> - 공통 컴포넌트는 `common`의 하위에 위치 <br/> - 그 외 컴포넌트는 `main`의 하위로 위치
constant | 상수들이 모여 있는 폴더
hook | hook 이 모여 있는 폴더
page | 페이지들이 모여 있는 폴더
style | 스타일 관련 파일(폰트 크기, 색상)들이 있는 폴더
type | 타입들이 모여 있는 폴더
util | 유틸리티 관련 함수들이 모인 폴더

## 주안점

### 모니터링이라는 관점에서 어떤 서비스를 제공해야 할까요? 🤔

모니터링 서비스에는 어떠한 기능이 필요할까요?  
저는 `모니터링이라는 서비스가 필요한 이유는 무엇일까요?`라는 질문에서부터 곰곰히 생각해보았습니다.  
제가 내린 결론은 **실시간으로 서비스의 가용성을 보여주는 것**입니다.

이전의 AWS의 Metrics, vercel의 Analytics 등 수많은 모니터링 서비스를 보면 아래와 같은 공통점이 있습니다.  

- 현재 사용할 수 있는 리소스량을 보여준다.
- 유저 경험 등 사용자에 기반한 지표를 보여준다.

따라서, 해당 과제의 목표로 아래와 같은 컴포넌트를 만들고자 했습니다.

- 금일 사용자를 보여주는 위젯
- 평균 응답시간보여주는 위젯
- DB 트랜젝션량을 보여주는 위젯
- 예외 발생을 보여주는 위젯

### 컴포넌트 렌더링 최적화 🧹

데이터 fetch 와 컴포넌트 렌더링 최적화에 고민하였습니다.
많은 위젯이 있으면 있을 수록 더 많은 데이터가 필요합니다.  
그리고 모니터링의 특성상 실시간성이 요구됩니다.
따라서, 많은 데이터를 실시간으로 가져오면서 화면을 보여주는 방법을 고민하였습니다.

아래는 위의 문제에 대해 제가 생각한 해결책입니다.

- cache를 이용한다.
- 데이터와 컴포넌트 로직을 분리한다.

즉, 데이터의 로직과 캐시를 적절히 이용하는 방법을 생각하였고  
`react-query`를 사용하게 되었습니다.  

`react-query`를 이용하면 stale과 cachetime 설정을 쉽게할 수 있습니다.  
또한 `useQuery` 같은 hook을 제공하므로 커스텀훅으로 만들어 데이터의 로직을 모듈화하면 컴포넌트의 로직과 분리될 수 있다고 생각였습니다.
